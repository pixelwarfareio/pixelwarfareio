// https://pixelwarfare.org/wp-includes/js/wp-embed.min.js?ver=5.4.8
/*! This file is auto-generated */
(function(window, document) {
  "use strict";

  var isModern = false, initialized = false;

  if (document.querySelector) {
    if (window.addEventListener) isModern = true;
  }

  if (!window.wp) window.wp = {};
  if (!window.wp.receiveEmbedMessage) {
    window.wp.receiveEmbedMessage = function(event) {
      var data = event.data;
      if (data && (data.secret || data.message || data.value)) {
        if (!/[^a-zA-Z0-9]/.test(data.secret)) {
          var iframes = document.querySelectorAll('iframe[data-secret="' + data.secret + '"]');
          var blockquotes = document.querySelectorAll('blockquote[data-secret="' + data.secret + '"]');

          for (var i = 0; i < blockquotes.length; i++) {
            blockquotes[i].style.display = "none";
          }

          for (var i = 0; i < iframes.length; i++) {
            var iframe = iframes[i];

            if (event.source === iframe.contentWindow) {
              iframe.removeAttribute("style");

              if (data.message === "height") {
                var height = parseInt(data.value, 10);
                if (height > 1000) height = 1000;
                else if (~~height < 200) height = 200;
                iframe.height = height;
              }

              if (data.message === "link") {
                var currentURL = document.createElement("a");
                var targetURL = document.createElement("a");

                currentURL.href = iframe.getAttribute("src");
                targetURL.href = data.value;

                if (targetURL.host === currentURL.host) {
                  if (document.activeElement === iframe) {
                    window.top.location.href = data.value;
                  }
                }
              }
            }
          }
        }
      }
    };

    if (isModern) {
      window.addEventListener("message", window.wp.receiveEmbedMessage, false);
      document.addEventListener("DOMContentLoaded", init, false);
      window.addEventListener("load", init, false);
    }

    function init() {
      if (initialized) return;
      initialized = true;

      var isIE10 = navigator.appVersion.indexOf("MSIE 10") !== -1;
      var isIE11 = !!navigator.userAgent.match(/Trident.*rv:11\./);
      var iframes = document.querySelectorAll("iframe.wp-embedded-content");

      for (var i = 0; i < iframes.length; i++) {
        var iframe = iframes[i];

        if (!iframe.getAttribute("data-secret")) {
          var secret = Math.random().toString(36).substr(2, 10);
          iframe.src += "#?secret=" + secret;
          iframe.setAttribute("data-secret", secret);
        }

        if (isIE10 || isIE11) {
          var clone = iframe.cloneNode(true);
          clone.removeAttribute("security");
          iframe.parentNode.replaceChild(clone, iframe);
        }
      }
    }
  }
})(window, document);
